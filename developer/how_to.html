
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>How to use the model for single-point calculation &#8212; pvfactors 0.1.4 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="pvfactors: Jupyter notebook guide" href="pvfactors_demo.html" />
    <link rel="prev" title="Developer docs" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/sp_2014_logo_black_orange_rgb.png" alt="Logo"/>
    
  </a>
</p>






<p>
<iframe src="https://ghbtns.com/github-btn.html?user=SunPower&repo=pvfactors&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../theory/index.html">Theory</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Developer docs</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">How to use the model for single-point calculation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instantiate-pv-array-class">Instantiate PV array class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualize-pv-array-lines">Visualize PV array lines</a></li>
<li class="toctree-l3"><a class="reference internal" href="#update-pv-array-angles">Update PV array angles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-irradiance-terms">Calculate irradiance terms</a></li>
<li class="toctree-l3"><a class="reference internal" href="#surface-registry">Surface registry</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="pvfactors_demo.html">pvfactors: Jupyter notebook guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="class_details.html">Details on classes and modules</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../whatsnew.html">What’s New</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Developer docs</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Developer docs</a></li>
      <li>Next: <a href="pvfactors_demo.html" title="next chapter">pvfactors: Jupyter notebook guide</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-use-the-model-for-single-point-calculation">
<span id="how-to"></span><h1>How to use the model for single-point calculation<a class="headerlink" href="#how-to-use-the-model-for-single-point-calculation" title="Permalink to this headline">¶</a></h1>
<div class="line-block">
<div class="line">Below is a description of the main steps order to run a calculation for a single (time) point. The following schematic summarizes it. This section should be used as a complement to the following Python Jupyter notebook guide: <a class="reference internal" href="pvfactors_demo.html"><span class="doc">pvfactors: Jupyter notebook guide</span></a></div>
<div class="line">The notebook also describes how to use the model for timeseries calculations (as opposed to single time point).</div>
</div>
<div class="figure">
<img alt="../_images/pvfactors_process.png" src="../_images/pvfactors_process.png" />
</div>
<div class="section" id="instantiate-pv-array-class">
<h2>Instantiate PV array class<a class="headerlink" href="#instantiate-pv-array-class" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">In order to use the model, the first step is to instantiate the <code class="docutils literal notranslate"><span class="pre">Array</span></code> class using the desired geometry parameters. Based on the inputs, the algorithm will create a 2D model of the PV array using <code class="docutils literal notranslate"><span class="pre">shapely</span></code> objects.</div>
<div class="line">The class will also automatically calculate the view factors for the specified configuration and rotation angles.</div>
</div>
<dl class="class">
<dt>
<em class="property">class </em><code class="descclassname">pvarray.</code><code class="descname">Array</code><span class="sig-paren">(</span><em>n_pvrows=3</em>, <em>pvrow_height=1.5</em>, <em>pvrow_width=1.0</em>, <em>surface_tilt=20.0</em>, <em>surface_azimuth=180.0</em>, <em>solar_zenith=0.0</em>, <em>solar_azimuth=180.0</em>, <em>rho_ground=0.2</em>, <em>rho_back_pvrow=0.05</em>, <em>rho_front_pvrow=0.03</em>, <em>gcr=0.3</em>, <em>**kwargs</em><span class="sig-paren">)</span></dt>
<dd><div class="line-block">
<div class="line">Create the array object. This will call the <a class="reference internal" href="class_details.html#pvarray.Array.update_view_factors" title="pvarray.Array.update_view_factors"><code class="xref py py-meth docutils literal notranslate"><span class="pre">update_view_factors()</span></code></a></div>
<div class="line">method which creates the shapely geometry and calculate the view</div>
<div class="line">factors based on the inputs.</div>
<div class="line">Azimuth angles are counted positive going East from North. E.g. 0 deg is</div>
<div class="line">North and 90 degrees is East.</div>
<div class="line">#FIXME The array azimuth uses a different convention than pvlib: for the</div>
<div class="line">torque-tube axis to be oriented South-North, the array azimuth angle</div>
<div class="line">needs to be 90 deg. And 0 deg would be East-West orientation.</div>
<div class="line">This assumes an equal spacing (or GCR) between all pv rows.</div>
<div class="line">This assumes that all pv rows have identical rotation angles.</div>
<div class="line">This assumes that all pv rows are at the same elevation (only x-values</div>
<div class="line">change from a pv row to another).</div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>n_pvrows</strong> (<em>int</em>) – number of PV rows in parallel</li>
<li><strong>pvrow_height</strong> (<em>float</em>) – height of PV rows, measured from ground to
center [meters]</li>
<li><strong>pvrow_width</strong> (<em>float</em>) – width of PV rows, in the considered 2D
dimension [meters]</li>
<li><strong>surface_tilt</strong> (<em>float</em>) – Surface tilt angles in decimal degrees.
surface_tilt must be &gt;=0 and &lt;=180.
The tilt angle is defined as degrees from horizontal
(e.g. surface facing up = 0, surface facing horizon = 90)</li>
<li><strong>surface_azimuth</strong> (<em>float</em>) – The azimuth of the rotated panel,
determined by projecting the vector normal to the panel’s surface
to the earth’s surface [degrees].</li>
<li><strong>solar_zenith</strong> (<em>float</em>) – zenith angle of the sun [degrees]</li>
<li><strong>solar_azimuth</strong> (<em>float</em>) – azimuth angle of the sun [degrees]</li>
<li><strong>rho_ground</strong> (<em>float</em>) – ground albedo</li>
<li><strong>rho_back_pvrow</strong> (<em>float</em>) – reflectivity of PV row’s back surface</li>
<li><strong>rho_front_pvrow</strong> (<em>float</em>) – reflectivity of PV row’s front surface</li>
<li><strong>gcr</strong> (<em>float</em>) – ground coverage ratio of the PV array</li>
<li><strong>kwargs</strong> – possible options are: <code class="docutils literal notranslate"><span class="pre">pvrow_class</span></code> if the user wants
to specify its own PV Row class; <code class="docutils literal notranslate"><span class="pre">cut</span></code> if the user wants to
discretize some pv rows, e.g. [(0, 5, ‘front’), (4, 2, ‘back’)]
will discretize the front surface of the first PV row into 5 segments,
and the back surface of the 5th pv row into 2 segments;
<code class="docutils literal notranslate"><span class="pre">calculate_front_circ_horizon_shading</span></code> is a boolean that indicates
whether to calculate front circumsolar &amp; horizon band shading or not;
<code class="docutils literal notranslate"><span class="pre">circumsolar_angle</span></code> would be the full (not half) angle of the
circumsolar disk; <code class="docutils literal notranslate"><span class="pre">horizon_band_angle</span></code> would be the horizon band
elevation angle</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="visualize-pv-array-lines">
<h2>Visualize PV array lines<a class="headerlink" href="#visualize-pv-array-lines" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">The user can easily visualize the array by plotting the <code class="docutils literal notranslate"><span class="pre">shapely</span></code> lines that it’s comprised of.</div>
<div class="line">The <code class="docutils literal notranslate"><span class="pre">plot_pvarray</span></code> and <code class="docutils literal notranslate"><span class="pre">plot_array_from_registry</span></code> functions located in the <code class="docutils literal notranslate"><span class="pre">plot</span></code> module should be used in combination with the <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> package for visualization.</div>
</div>
<dl class="function">
<dt>
<code class="descclassname">plot.</code><code class="descname">plot_pvarray</code><span class="sig-paren">(</span><em>ax</em>, <em>pvarray</em>, <em>line_types_selected=None</em>, <em>fontsize=20</em><span class="sig-paren">)</span></dt>
<dd><p>Plot a 2D PV array from a <a class="reference internal" href="class_details.html#pvarray.Array" title="pvarray.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">pvarray.Array</span></code></a> using its
<code class="xref py py-attr docutils literal notranslate"><span class="pre">pvarray.Array.surface_registry</span></code>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ax</strong> – <code class="xref py py-class docutils literal notranslate"><span class="pre">matplotlib.axes.Axes</span></code> object to use for the plot</li>
<li><strong>pvarray</strong> (<a class="reference internal" href="class_details.html#pvarray.Array" title="pvarray.Array"><code class="xref py py-class docutils literal notranslate"><span class="pre">pvarray.Array</span></code></a>) – object containing the surface registry as attribute</li>
<li><strong>line_types_selected</strong> (<em>list</em>) – parameter used to select a subset of
‘line_type’ to plot; e.g. ‘pvrow’ or ‘ground’</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None (<code class="docutils literal notranslate"><span class="pre">ax</span></code> is updated)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="update-pv-array-angles">
<h2>Update PV array angles<a class="headerlink" href="#update-pv-array-angles" title="Permalink to this headline">¶</a></h2>
<div class="line-block">
<div class="line">After creating a PV array object, the user can update the rotation and solar angles using the <code class="docutils literal notranslate"><span class="pre">update_view_factors</span></code> method.</div>
</div>
<dl class="method">
<dt>
<code class="descclassname">Array.</code><code class="descname">update_view_factors</code><span class="sig-paren">(</span><em>solar_zenith</em>, <em>solar_azimuth</em>, <em>surface_tilt</em>, <em>surface_azimuth</em><span class="sig-paren">)</span></dt>
<dd><p>Create new line and surface registries based on new inputs, and re-cal-
culate the view factor matrix of the updated system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solar_zenith</strong> (<em>float</em>) – zenith angle of the sun [in deg]</li>
<li><strong>solar_azimuth</strong> (<em>float</em>) – azimuth angle of the sun [in deg]</li>
<li><strong>surface_tilt</strong> (<em>float</em>) – Surface tilt angles in decimal degrees.
surface_tilt must be &gt;=0 and &lt;=180.
The tilt angle is defined as degrees from horizontal
(e.g. surface facing up = 0, surface facing horizon = 90)</li>
<li><strong>surface_azimuth</strong> (<em>float</em>) – The azimuth of the rotated panel,
determined by projecting the vector normal to the panel’s surface
to the earth’s surface [degrees].</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="calculate-irradiance-terms">
<h2>Calculate irradiance terms<a class="headerlink" href="#calculate-irradiance-terms" title="Permalink to this headline">¶</a></h2>
<p>After creating a PV array object, the user can calculate all of the irradiance terms described in the problem formulation.
The ouputs of the calculation will be written into the <code class="docutils literal notranslate"><span class="pre">surface_registry</span></code>. The approach builds on top of the Perez diffuse light transposition model.</p>
<dl class="method">
<dt>
<code class="descclassname">Array.</code><code class="descname">calculate_radiosities_perez</code><span class="sig-paren">(</span><em>solar_zenith</em>, <em>solar_azimuth</em>, <em>surface_tilt</em>, <em>surface_azimuth</em>, <em>dni</em>, <em>luminance_isotropic</em>, <em>luminance_circumsolar</em>, <em>poa_horizon</em>, <em>poa_circumsolar</em><span class="sig-paren">)</span></dt>
<dd><p>Solve linear system of equations to calculate radiosity terms based on
the specified inputs and using Perez diffuse light transposition model
pre-calculated values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>solar_zenith</strong> (<em>float</em>) – zenith angle of the sun [degrees]</li>
<li><strong>solar_azimuth</strong> (<em>float</em>) – azimuth angle of the sun [degrees]</li>
<li><strong>surface_tilt</strong> (<em>float</em>) – Surface tilt angles in decimal degrees.
surface_tilt must be &gt;=0 and &lt;=180.
The tilt angle is defined as degrees from horizontal
(e.g. surface facing up = 0, surface facing horizon = 90)</li>
<li><strong>surface_azimuth</strong> (<em>float</em>) – The azimuth of the rotated panel,
determined by projecting the vector normal to the panel’s surface
to the earth’s surface [degrees].</li>
<li><strong>dni</strong> (<em>float</em>) – direct normal irradiance [W/m2]</li>
<li><strong>luminance_isotropic</strong> (<em>float</em>) – luminance of the isotropic part of
the sky dome [W/m2/sr]</li>
<li><strong>luminance_circumsolar</strong> (<em>float</em>) – luminance of the circumsolar part
of the sky dome [W/m2/sr]</li>
<li><strong>poa_horizon</strong> (<em>float</em>) – plane-of-array horizon component of the
irradiance as calculated by Perez for the front surface of a PV row
[W/m2]</li>
<li><strong>poa_circumsolar</strong> (<em>float</em>) – plane-of-array circumsolar component of
the irradiance as calculated by Perez for the front surface of a PV
row [W/m2]</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None; updating <code class="xref py py-attr docutils literal notranslate"><span class="pre">surface_registry</span></code></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="surface-registry">
<h2>Surface registry<a class="headerlink" href="#surface-registry" title="Permalink to this headline">¶</a></h2>
<p>In the end, the core information and results about the PV array object will be stored in its <code class="docutils literal notranslate"><span class="pre">surface_registry</span></code> attribute of the <code class="docutils literal notranslate"><span class="pre">Array</span></code> object.</p>
</div>
</div>


          </div>
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;Copyright 2016, SunPower Corporation.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/developer/how_to.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/SunPower/pvfactors" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>